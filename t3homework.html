<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>T3_Base - Homework Manager</title>

  <!-- Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root {
      --bg-dark: #1e1e1e;
      --bg-light: #f8f9fa;
      --card-dark: #2b2b2b;
      --card-light: #ffffff;
      --text-dark: #f0f0f0;
      --text-light: #222;
      --text-muted: #888;
      --accent: #3a86ff;
    }

    [data-theme="dark"] {
      --bg: var(--bg-dark);
      --card: var(--card-dark);
      --text: var(--text-dark);
    }
    [data-theme="light"] {
      --bg: var(--bg-light);
      --card: var(--card-light);
      --text: var(--text-light);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Inter", sans-serif; }
    body { background: var(--bg); color: var(--text); min-height: 100vh; display: flex; flex-direction: column; transition: background 0.3s, color 0.3s; }

    /* Navbar */
    .navbar { background: var(--card); padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,.2); position: sticky; top: 0; z-index: 10; }
    .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1100px; margin: auto; flex-wrap: wrap; }
    .nav-brand { font-size: 1.3rem; font-weight: bold; display: flex; align-items: center; gap: .5rem; }
    .nav-menu { display: flex; gap: 1rem; align-items: center; }
    .nav-menu button { background: var(--accent); border: none; padding: .5rem 1rem; border-radius: 6px; cursor: pointer; color: white; font-weight: 500; transition: background 0.3s; }
    .nav-menu button:hover { background: #2f5fcc; }

    /* Content */
    .main-content { flex: 1; max-width: 1100px; margin: auto; padding: 2rem 1rem; width: 100%; }
    .page-title { font-size: 2rem; margin-bottom: .5rem; }
    .page-subtitle { color: var(--text-muted); margin-bottom: 2rem; }

    .homework-list { display: grid; gap: 1rem; }
    .homework-card { background: var(--card); padding: 1.2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,.2); transition: transform 0.2s; }
    .homework-card:hover { transform: translateY(-3px); }
    .homework-card h4 { margin-bottom: .5rem; }
    .homework-meta { font-size: .9rem; color: var(--text-muted); margin-bottom: .5rem; }
    .homework-images { display: flex; flex-wrap: wrap; gap: .5rem; margin: .5rem 0; }
    .homework-images .image-wrapper { position: relative; }
    .homework-images img { max-width: 120px; border-radius: 8px; }
    .more-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; border-radius: 8px; }

    .form-card { background: var(--card); padding: 1.5rem; border-radius: 12px; margin-top: 2rem; box-shadow: 0 2px 6px rgba(0,0,0,.2); }
    .form-group { margin-bottom: 1rem; }
    .form-group label { display: block; margin-bottom: .3rem; font-size: .9rem; }
    .form-group input, .form-group textarea, .form-group select { width: 100%; padding: .6rem; border-radius: 6px; border: 1px solid #ccc; background: transparent; color: inherit; transition: border 0.3s; }
    .form-group input:focus, .form-group textarea:focus { border-color: var(--accent); outline: none; }
    .form-group textarea { resize: none; }
    .button-group { display: flex; gap: 1rem; }
    .button-group button { flex: 1; padding: .7rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: opacity 0.3s; }
    .submit-btn { background: var(--accent); color: white; }
    .submit-btn:hover { opacity: 0.9; }
    .clear-btn { background: #888; color: white; }
    .clear-btn:hover { opacity: 0.9; }

    .preview-container { display: flex; gap: .5rem; flex-wrap: wrap; margin-top: .5rem; }
    .preview-container img { max-width: 120px; border-radius: 8px; }

    /* Footer */
    .footer { background: var(--card); padding: 1rem; text-align: center; font-size: .9rem; color: var(--text-muted); margin-top: auto; }

    /* Responsive */
    @media(max-width:768px){
      .nav-container { flex-direction: column; gap: 1rem; align-items: flex-start; }
      .button-group { flex-direction: column; }
    }
  </style>
</head>
<body data-theme="dark">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <i class="fas fa-graduation-cap"></i> T3_Base
      </div>
      <div class="nav-menu">
        <button id="themeToggle"><i class="fas fa-adjust"></i></button>
        <button id="uploadToggle"><i class="fas fa-upload"></i> Upload Homework</button>
      </div>
    </div>
  </nav>

  <!-- Main -->
  <main class="main-content">
    <h1 class="page-title">Homework Manager (T3)</h1>
    <p class="page-subtitle">Manage assignments with auto-expiry after 10 days</p>

    <!-- Homework list -->
    <div id="homeworkList" class="homework-list"></div>

    <!-- Form (hidden until button click) -->
    <div id="formContainer" class="form-card" style="display:none;">
      <h3>Post Homework</h3>
      <form id="homeworkForm">
        <div class="form-group">
          <label for="teacherName">Teacher Name</label>
          <input type="text" id="teacherName" required />
        </div>
        <div class="form-group">
          <label for="homeworkImages">Upload Images</label>
          <input type="file" id="homeworkImages" accept="image/*" multiple />
          <div id="previewContainer" class="preview-container"></div>
        </div>
        <div class="form-group">
          <label for="subject">Subject</label>
          <input type="text" id="subject" required />
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" rows="4" required></textarea>
        </div>
        <div class="form-group">
          <label for="dueDate">Due Date</label>
          <input type="date" id="dueDate" required />
        </div>
        <div class="button-group">
          <button type="submit" class="submit-btn">Submit</button>
          <button type="reset" class="clear-btn">Clear</button>
        </div>
      </form>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    Homework Manager © T3_Base — Everyone can view & upload homework
  </footer>

  <!-- Script -->
  <script>
    const themeToggle = document.getElementById("themeToggle");
    const uploadToggle = document.getElementById("uploadToggle");
    const formContainer = document.getElementById("formContainer");
    const homeworkForm = document.getElementById("homeworkForm");
    const homeworkList = document.getElementById("homeworkList");
    const homeworkImages = document.getElementById("homeworkImages");
    const previewContainer = document.getElementById("previewContainer");

    // Theme toggle
    themeToggle.addEventListener("click", () => {
      const currentTheme = document.body.getAttribute("data-theme");
      document.body.setAttribute("data-theme", currentTheme === "dark" ? "light" : "dark");
    });

    // Toggle upload form
    uploadToggle.addEventListener("click", () => {
      formContainer.style.display = formContainer.style.display === "none" ? "block" : "none";
    });

    // Multiple image preview
    homeworkImages.addEventListener("change", (e) => {
      previewContainer.innerHTML = "";
      const files = Array.from(e.target.files);
      files.forEach(file => {
        const reader = new FileReader();
        reader.onload = (ev) => {
          const img = document.createElement("img");
          img.src = ev.target.result;
          previewContainer.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    });

    // Load homework from localStorage
    const loadHomework = () => {
      homeworkList.innerHTML = "";
      const stored = JSON.parse(localStorage.getItem("homework")) || [];
      const now = new Date();
      const valid = stored.filter(hw => new Date(hw.createdAt).getTime() + 10*24*60*60*1000 > now.getTime());
      localStorage.setItem("homework", JSON.stringify(valid));
      valid.forEach(hw => {
        const card = document.createElement("div");
        card.className = "homework-card";

        let imagesHTML = "";
        if (hw.images && hw.images.length > 0) {
          hw.images.slice(0,4).forEach((src, i) => {
            if (i === 3 && hw.images.length > 4) {
              imagesHTML += `
                <div class="image-wrapper">
                  <img src="${src}" />
                  <div class="more-overlay">+${hw.images.length - 3} more</div>
                </div>`;
            } else {
              imagesHTML += `<div class="image-wrapper"><img src="${src}" /></div>`;
            }
          });
        }

        card.innerHTML = `
          <h4>${hw.subject}</h4>
          <div class="homework-meta">By ${hw.teacher} | Due: ${hw.dueDate}</div>
          <div class="homework-images">${imagesHTML}</div>
          <p>${hw.description}</p>
        `;
        homeworkList.appendChild(card);
      });
    };

    // Handle submit
    homeworkForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const teacher = document.getElementById("teacherName").value;
      const subject = document.getElementById("subject").value;
      const description = document.getElementById("description").value;
      const dueDate = document.getElementById("dueDate").value;

      const files = Array.from(homeworkImages.files);
      const readers = files.map(file => new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = (ev) => resolve(ev.target.result);
        reader.readAsDataURL(file);
      }));

      Promise.all(readers).then(images => {
        saveHomework(teacher, subject, description, dueDate, images);
      });
    });

    function saveHomework(teacher, subject, description, dueDate, images) {
      const hw = { teacher, subject, description, dueDate, images, createdAt: new Date() };
      const stored = JSON.parse(localStorage.getItem("homework")) || [];
      stored.push(hw);
      localStorage.setItem("homework", JSON.stringify(stored));
      homeworkForm.reset();
      previewContainer.innerHTML = "";
      formContainer.style.display = "none";
      loadHomework();
    }

    // Init
    loadHomework();
  </script>
</body>
</html>
